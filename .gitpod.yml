image: gitpod/workspace-full

tasks:
  - name: Setup all projects
    init: pnpm i
    command: |
      cd apps/classroomio-com &&
      cp .env.example .env &&
      cd ../dashboard &&
      cp .env.example .env &&
      SUPABASE_ANON_KEY=(supabase status | grep "anon key" | awk '{print $3}' | tr -d '\\n') &&
      sed -i "s/PUBLIC_SUPABASE_ANON_KEY=.*/SUPABASE_ANON_KEY=$SUPABASE_ANON_KEY/g" .env &&
      cd ../.. &&
      pnpm supabase start

ports:
  - port: 3000
    visibility: public
    onOpen: open-browser
  - port: 5173
    visibility: public
    onOpen: open-browser
  - port: 5174
    visibility: public
    onOpen: open-browser
  - port: 54321
    visibility: public
    onOpen: ignore
  - port: 54323
    visibility: public
    onOpen: ignore
  - port: 54324
    visibility: public
    onOpen: ignore
